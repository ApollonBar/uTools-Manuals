<div class="header">
<div class="subTitle">
     compact1, compact2, compact3 
   </div>
<div class="subTitle">
     java.nio.file 
   </div>
<h2 class="title" title="Interface WatchService">Interface WatchService</h2>
</div><div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>
         All Superinterfaces: 
       </dt>
<dd>
<span><a href="../../../java/lang/AutoCloseable.html" title="java.lang中的接口">AutoCloseable</a> ， <a href="../../../java/io/Closeable.html" title="java.io中的接口">Closeable</a></span>
</dd>
</dl>
<hr/> <br/> <pre>public interface <span class="typeNameLabel">WatchService</span>
extends <a href="../../../java/io/Closeable.html" title="interface in java.io">Closeable</a></pre>
<div class="block">
<span><em>监视</em>注册对象进行更改和事件的监视服务。</span>
<span>例如，文件管理器可以使用监视服务来监视目录以进行更改，以便可以在创建或删除文件时更新其文件列表的显示。</span>
<p> <span>一个<a href="../../../java/nio/file/Watchable.html" title="java.nio.file中的接口"><code>Watchable</code></a>对象通过调用其<a href="../../../java/nio/file/Watchable.html#register-java.nio.file.WatchService-java.nio.file.WatchEvent.Kind:A-java.nio.file.WatchEvent.Modifier...-"><code>register</code></a>方法<a href="../../../java/nio/file/WatchKey.html" title="java.nio.file中的接口">注册</a>到watch服务，返回一个<a href="../../../java/nio/file/WatchKey.html" title="java.nio.file中的接口"><code>WatchKey</code></a>来表示注册。</span> <span>当检测到的对象的事件的键<em>发出信号</em> ，如果当前没有信号，这是排队，以便它可以由消费者调用来检索表服务<a href="../../../java/nio/file/WatchService.html#poll--"><code>poll</code>种</a>或<a href="../../../java/nio/file/WatchService.html#take--"><code>take</code></a>方法来检索键和处理事件。</span> <span>一旦事件被处理，消费者就会调用密钥的<a href="../../../java/nio/file/WatchKey.html#reset--"><code>reset</code></a>方法来重置密钥，该密钥允许密钥被发信号并且进一步重新排队。</span> </p>
<p> <span>通过调用密钥的<a href="../../../java/nio/file/WatchKey.html#cancel--"><code>cancel</code></a>方法注销观看服务。</span> <span>在被取消的时间排队的密钥保留在队列中，直到它被检索为止。</span> <span>根据对象，可能会自动取消键。</span> <span>例如，假设目录被监视，并且监视服务检测到它已被删除或其文件系统不再可访问。</span> <span>当以这种方式取消密钥时，它将被发信号通知并排队，如果当前没有发出信号。</span> <span>为确保消费者得到通知， <code>reset</code>方法的返回值表示该键是否有效。</span> </p>
<p> <span>手表服务可以安全使用多个并发消费者。</span> <span>为了确保只有一个消费者在任何时候处理特定对象的事件，则应注意确保密钥的<code>reset</code>方法仅在其事件处理完毕后才被调用。</span> <span>可以随时调用<a href="../../../java/nio/file/WatchService.html#close--"><code>close</code></a>方法来关闭导致任何线程等待检索密钥的服务，以抛出<code>ClosedWatchServiceException</code> 。</span> </p>
<p> <span>文件系统可以比可以检索或处理的事件更快地报告事件，并且实现可能会对其可能累积的事件数量施加未指定的限制。</span> <span>如果一个实现<em>知道</em>丢弃事件，那么它将安排密钥的<a href="../../../java/nio/file/WatchKey.html#pollEvents--"><code>pollEvents</code></a>方法来返回事件类型为<a href="../../../java/nio/file/StandardWatchEventKinds.html#OVERFLOW"><code>OVERFLOW</code>的元素</a> 。</span> <span>消费者可以使用此事件作为重新检查对象状态的触发器。</span> </p>
<p> <span>当一个事件被报告以指示被监视的目录中的文件已被修改时，则不能保证修改该文件的程序（或程序）已经完成。</span> <span>应注意与可能正在更新文件的其他程序协调访问。</span> <span><a href="../../../java/nio/channels/FileChannel.html" title="java.nio.channels中的类"><code>FileChannel</code></a>类定义了将文件的区域锁定到其他程序访问的方法。</span> </p>
<h2> <span>平台依赖</span> </h2>
<p> <span>从文件系统观察事件的实现旨在直接映射到可用的本机文件事件通知工具，或者在本机设备不可用时使用原始机制（如轮询）。</span> <span>因此，关于如何检测事件，及时性以及是否保存其顺序的许多细节都是具体实现的。</span> <span>例如，当观察目录中的文件被修改时，可能会导致一些实现中的单个<a href="../../../java/nio/file/StandardWatchEventKinds.html#ENTRY_MODIFY"><code>ENTRY_MODIFY</code></a>事件，而在其他实现中会导致一些事件。</span> <span>短期文件（意味着在创建后被非常快速地删除的文件）可能不会被定期轮询文件系统以检测更改的原始实现来检测。</span> </p>
<p> <span>如果观看的文件不在本地存储设备上，那么如果可以检测到文件的更改，那么它是实现特定的。</span> <span>特别地，不需要检测在远程系统上执行的文件的更改。</span> </p>
</div>
<dl>
<dt>
<span class="simpleTagLabel">从以下版本开始：</span>
</dt>
<dd>
         1.7 
       </dd>
<dt>
<span class="seeLabel">另请参见：</span>
</dt>
<dd>
<a href="../../../java/nio/file/FileSystem.html#newWatchService--"><code>FileSystem.newWatchService()</code></a>
</dd>
</dl> </li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!-- --> </a> <h3>方法摘要</h3>
<table border="0" cellpadding="3" cellspacing="0" class="memberSummary" summary="Method Summary table, listing methods, and an explanation">
<caption>
<span class="activeTableTab" id="t0"><span>所有方法</span><span class="tabEnd"> </span></span>
<span class="tableTab" id="t2"><span><a href="javascript:show(2);">接口方法</a></span><span class="tabEnd"> </span></span>
<span class="tableTab" id="t3"><span><a href="javascript:show(4);">抽象方法</a></span><span class="tabEnd"> </span></span>
</caption>
<tbody>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor" id="i0">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../java/nio/file/WatchService.html#close--">close</a></span>()</code>
<div class="block">
              关闭这个手表服务。 
            </div> </td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code><a href="../../../java/nio/file/WatchKey.html" title="interface in java.nio.file">WatchKey</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../java/nio/file/WatchService.html#poll--">poll</a></span>()</code>
<div class="block">
              检索并删除下一个watch键，如果没有，则 
             <code>null</code> 。 
            </div> </td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code><a href="../../../java/nio/file/WatchKey.html" title="interface in java.nio.file">WatchKey</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../java/nio/file/WatchService.html#poll-long-java.util.concurrent.TimeUnit-">poll</a></span>(long timeout, <a href="../../../java/util/concurrent/TimeUnit.html" title="enum in java.util.concurrent">TimeUnit</a> unit)</code>
<div class="block">
              检索并删除下一个watch键，如果还没有，则等待必要时直到指定的等待时间。 
            </div> </td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code><a href="../../../java/nio/file/WatchKey.html" title="interface in java.nio.file">WatchKey</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../java/nio/file/WatchService.html#take--">take</a></span>()</code>
<div class="block">
              检索并删除下一个Watch键，等待是否还没有。 
            </div> </td>
</tr>
</tbody>
</table> </li>
</ul> </li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!-- --> </a> <h3>方法详细信息</h3> <a name="close--">
<!-- --> </a>
<ul class="blockList">
<li class="blockList"> <h4>close</h4> <pre>void close()
    throws <a href="../../../java/io/IOException.html" title="class in java.io">IOException</a></pre>
<div class="block">
<span>关闭这个手表服务。</span>
<p> <span>如果一个线程当前被阻塞在<a href="../../../java/nio/file/WatchService.html#take--"><code>take</code></a>或<a href="../../../java/nio/file/WatchService.html#poll-long-java.util.concurrent.TimeUnit-"><code>poll</code></a>方法等待一个密钥排队，那么它会立即收到一个<a href="../../../java/nio/file/ClosedWatchServiceException.html" title="java.nio.file中的类"><code>ClosedWatchServiceException</code></a> 。</span> <span>与此手表服务相关<a href="../../../java/nio/file/WatchKey.html#isValid--">联的</a>任何有效键均为<a href="../../../java/nio/file/WatchKey.html#isValid--"><code>invalidated</code></a> 。</span> </p>
<p> <span>在关闭手表服务之后，任何进一步调用操作的尝试将会抛出<a href="../../../java/nio/file/ClosedWatchServiceException.html" title="java.nio.file中的类"><code>ClosedWatchServiceException</code></a> 。</span> <span>如果这个watch服务已经关闭了，那么调用这个方法就没有效果。</span> </p>
</div>
<dl>
<dt>
<span class="overrideSpecifyLabel">Specified by:</span>
</dt>
<dd>
<code><a href="../../../java/lang/AutoCloseable.html#close--">close</a></code>中的 
            <code><a href="../../../java/lang/AutoCloseable.html" title="interface in java.lang">AutoCloseable</a></code>
</dd>
<dt>
<span class="overrideSpecifyLabel">Specified by:</span>
</dt>
<dd>
<code><a href="../../../java/io/Closeable.html#close--">close</a></code>在接口 
            <code><a href="../../../java/io/Closeable.html" title="interface in java.io">Closeable</a></code>
</dd>
<dt>
<span class="throwsLabel">异常</span>
</dt>
<dd>
<code><a href="../../../java/io/IOException.html" title="class in java.io">IOException</a></code> - 如果发生I / O错误 
           </dd>
</dl> </li>
</ul> <a name="poll--">
<!-- --> </a>
<ul class="blockList">
<li class="blockList"> <h4>poll</h4> <pre><a href="../../../java/nio/file/WatchKey.html" title="interface in java.nio.file">WatchKey</a> poll()</pre>
<div class="block">
            检索并删除下一个watch key，如果没有，则 
           <code>null</code> 。 
          </div>
<dl>
<dt>
<span class="returnLabel">结果</span>
</dt>
<dd>
             下一个手表键，或 
            <code>null</code>
</dd>
<dt>
<span class="throwsLabel">异常</span>
</dt>
<dd>
<code><a href="../../../java/nio/file/ClosedWatchServiceException.html" title="class in java.nio.file">ClosedWatchServiceException</a></code> - 如果这个手表服务是关闭的 
           </dd>
</dl> </li>
</ul> <a name="poll-long-java.util.concurrent.TimeUnit-">
<!-- --> </a>
<ul class="blockList">
<li class="blockList"> <h4>poll</h4> <pre><a href="../../../java/nio/file/WatchKey.html" title="interface in java.nio.file">WatchKey</a> poll(long timeout,
              <a href="../../../java/util/concurrent/TimeUnit.html" title="enum in java.util.concurrent">TimeUnit</a> unit)
       throws <a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></pre>
<div class="block">
            检索并删除下一个watch键，如果还没有，则等待必要时直到指定的等待时间。 
          </div>
<dl>
<dt>
<span class="paramLabel">参数</span>
</dt>
<dd>
<code>timeout</code> - 如何等待，放弃之前，单位单位 
           </dd>
<dd>
<code>unit</code> - a 
            <code>TimeUnit</code>确定如何解释超时参数 
           </dd>
<dt>
<span class="returnLabel">结果</span>
</dt>
<dd>
             下一个手表键，或 
            <code>null</code>
</dd>
<dt>
<span class="throwsLabel">异常</span>
</dt>
<dd>
<code><a href="../../../java/nio/file/ClosedWatchServiceException.html" title="class in java.nio.file">ClosedWatchServiceException</a></code> - 如果此手表服务关闭，或者在等待下一个键时关闭 
           </dd>
<dd>
<code><a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></code> - 如果在等待时中断 
           </dd>
</dl> </li>
</ul> <a name="take--">
<!-- --> </a>
<ul class="blockListLast">
<li class="blockList"> <h4>take</h4> <pre><a href="../../../java/nio/file/WatchKey.html" title="interface in java.nio.file">WatchKey</a> take()
       throws <a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></pre>
<div class="block">
            检索并删除下一个Watch键，等待是否还没有。 
          </div>
<dl>
<dt>
<span class="returnLabel">结果</span>
</dt>
<dd>
             下一个手表键 
           </dd>
<dt>
<span class="throwsLabel">异常</span>
</dt>
<dd>
<code><a href="../../../java/nio/file/ClosedWatchServiceException.html" title="class in java.nio.file">ClosedWatchServiceException</a></code> - 如果此手表服务关闭，或者在等待下一个键时关闭 
           </dd>
<dd>
<code><a href="../../../java/lang/InterruptedException.html" title="class in java.lang">InterruptedException</a></code> - if interrupted while waiting 
           </dd>
</dl> </li>
</ul> </li>
</ul> </li>
</ul>
</div>
</div>